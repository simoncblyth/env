#!/usr/bin/env python

from __future__ import print_function
import os, sys, logging
log = logging.getLogger(__name__)


def write_index_html(dir_):
    assert os.path.isdir(dir_), dir_
    opath = os.path.join(dir_, "index.html")
    if os.path.exists(opath):
        log.info("output path exists already %s : delete it and rerun to update " % opath)
    else:   
        #out = sys.stdout 
        log.info("writing to %s " % opath)
        out = file(opath, "w") 
        print("<html>", file=out) 
        print("<!-- generated by index.py -->", file=out)
        print("<!-- open http://localhost/env/presentation/index.html -->", file=out)
        print("<ul>", file=out)
        for htm in filter(lambda p:p.endswith(".html"), os.listdir(dir_)):
            print("<li> <a href=\"%s\"> %s </a> </li>" % (htm, htm), file=out)
        pass
        print("</ul>", file=out)
        print("</html>", file=out) 
    pass


if __name__ == '__main__':
    logging.basicConfig(level=logging.INFO)
    dir_ = sys.argv[1]
    write_index_html(dir_)

