
VRML2FILE Geometry Export
===========================

Export geometry by adding to `opw/fmcpmuon.py`, using inspiration from  :dybsvn:`source:dybgaudi/trunk/Simulation/DetSim/python/visdet.py`::

        #
        # tone down verbosity of G4RunManager, 
        # skipping the particle table dump for Verbosity less than 3
        # https://wiki.bnl.gov/dayabay/index.php?title=FAQ:How_to_turn_off_long_particle_listing%3F
        #
        from GiGa.GiGaConf import GiGa, GiGaRunManager
        giga = GiGa("GiGa")
        gigarm = GiGaRunManager("GiGa.GiGaMgr")
        gigarm.Verbosity = 2 

        #
        # geometry export attempt
        # 
        from GaussTools.GaussToolsConf import GiGaRunActionCommand
        grac = GiGaRunActionCommand("GiGa.GiGaRunActionCommand")
        grac.BeginOfRunCommands = [ 
             "/vis/open VRML2FILE",
             "/vis/drawVolume",
             "/vis/viewer/flush"
        ]    
        #from GiGa.GiGaConf import GiGa
        giga = GiGa()
        giga.RunAction = grac    
        giga.VisManager = "GiGaVisManager/GiGaVis"


Succeeded to create a .wrl::

    [blyth@belle7 20130820-1318]$ du -hs g4_00.wrl 
    82M     g4_00.wrl


::

    [blyth@belle7 20130820-1318]$ head -50 g4_00.wrl 
    #VRML V2.0 utf8
    # Generated by VRML 2.0 driver of GEANT4


    #---------- CAMERA
    Viewpoint {
            position 0 0 111042
    }

    #---------- SOLID: /dd/Structure/Sites/db-rock.1000
            Shape {
                    appearance Appearance {
                            material Material {
                                    diffuseColor 1 1 1
                                    transparency 0.7
                            }
                    }
                    geometry IndexedFaceSet {
                            coord Coordinate {
                                    point [
                                            18049.9 -809521 22890,
                                            -9108.86 -767540 22890,
                                            -51089.9 -794699 22890,
                                            -23931.1 -836680 22890,
                                            -23931.1 -836680 -15104.2,
                                            18049.9 -809521 -15104.2,
                                            -51089.9 -794699 -15104.2,
                                            -9108.86 -767540 -15104.2,
                                    ]
                            }
                            coordIndex [
                                    0, 1, 2, 3, -1,
                                    4, 5, 0, -1,
                                    0, 3, 4, -1,
                                    6, 4, 3, -1,
                                    3, 2, 6, -1,
                                    7, 6, 2, -1,
                                    2, 1, 7, -1,
                                    5, 7, 1, -1,
                                    1, 0, 5, -1,
                                    5, 4, 6, -1,
                                    6, 7, 5, -1,
                            ]
                            solid FALSE
                    }
            }
    #---------- SOLID: /dd/Geometry/Sites/lvNearSiteRock#pvNearHallTop.1000
            Shape {
                    appearance Appearance {
                            material Material {

With 12k solids::

    ...
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE1DeadLegs#pvLegInDead:2#pvLegInDeadUnit.2
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE1DeadLegs#pvLegInDead:3#pvLegInDeadUnit.3
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE1DeadLegs#pvLegInDead:4#pvLegInDeadUnit.4
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE2DeadLegs#pvLegInDead:1#pvLegInDeadUnit.1
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE2DeadLegs#pvLegInDead:2#pvLegInDeadUnit.2
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE2DeadLegs#pvLegInDead:3#pvLegInDeadUnit.3
    #---------- SOLID: /dd/Geometry/Pool/lvNearPoolDead#pvNearADE2DeadLegs#pvLegInDead:4#pvLegInDeadUnit.4
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab1.1001
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab2.1002
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab3.1003
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab4.1004
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab5.1005
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab6.1006
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab7.1007
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab8.1008
    #---------- SOLID: /dd/Geometry/Sites/lvNearHallBot#pvNearHallRadSlabs#pvNearHallRadSlab9.1009
    [blyth@belle7 20130820-1318]$ grep SOLID g4_00.wrl  | wc -l
    12229




BUT, many warnings.

.. literalinclude:: export.txt




